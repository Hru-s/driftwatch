# RBAC DRIFT: Weaker ops role in team-a (Cluster B only)
# Baseline role (both clusters) includes "delete" on Deployments.
# This version removes "delete" for Deployments, creating a "missing permission" in B.

apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: ops-manager
  namespace: team-a
  labels:
    driftwatch.scenario: "rbac-weaken-ops-manager-team-a"
    driftwatch.cluster: "b"
rules:
  - apiGroups: ["apps"]
    resources: ["deployments"]
    verbs:
      # Baseline: ["get", "list", "watch", "create", "update", "patch", "delete"]
      # Drift: "delete" removed here
      - get
      - list
      - watch
      - create
      - update
      - patch
  - apiGroups: [""]
    resources: ["pods"]
    verbs:
      - get
      - list
      - watch
      - delete
